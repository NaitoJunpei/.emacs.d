import matplotlib.pyplot as plt
import pandas as pd
import math

def KDE(spike_times) :
    spike_times = pd.Series(spike_times)
    max_value   = max(spike_times)
    min_value   = min(spike_times)
    onset       = min_value - 0.001 * (max_value - min_value)
    offset      = max_value - 0.001 * (max_value - min_value)

    optw = search_minimum(spike_times)
    opty = kernel(spike_times, optw)

    drawKDE(opty)

def search_minimum(spike_times) :
    C_min = np.inf
    for i in range(0, 50):
        W = (max_value - min_value) / (i + 1)
        C = Cost(spike_times, W)

        if (C < C_min) :
            C_min = C
            w = W

    return w

