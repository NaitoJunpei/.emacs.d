\section{モデリング手法\label{methods}}
子供が学習を継続するかどうかという問題を、ロジスティック回帰を使ってモデル化する。その中で、時系列クラスタリングを用いて、予測に利用する。

一人の子供に対して継続的に発達検査を行うため、データの時間変化を観察することができる。この時間変化が似ている子供は、学習を継続するか継続しないかに関して、似たような傾向があるだろうという発想に基づき、データの時間変化を予測に利用する。発達検査の4科目の得点について、時間ごとの変化を時系列データとみなし、4科目のそれぞれについて、時系列クラスタリングを行う。科目ごとに子供をクラスタに分類し、子供が属しているクラスタを特徴として予測に利用する。仮に科目ごとに10個のクラスタに分類する場合、属しているクラスタに対応する要素が1、残りの要素が0となるような10次元のベクトルを4つ、特徴として予測に利用することになる。

%時系列クラスタリングを行うためには、時系列データの距離を計算する必要がある。距離を計算する方法について、DTW距離と、ユークリッド距離の2つを試した。クラスタリングの方法には、階層的クラスタリングを用いた。
クラスタリングには、階層的クラスタリングを用いる。
階層的クラスタリングは、全てのデータ、およびクラスタ間の距離（類似度）を計算し、その中で最も距離が小さい（類似度が大きい）２つのデータまたはクラスタを統合し、新たなクラスタとすることを繰り返す方法である。最終的には全てのデータを１つのクラスタに統合する。仮に10個のクラスタに分ける場合、統合されていないデータ、およびクラスタの数が10個になった時点で終了する。階層的クラスタリングをする際には、クラスタ間の距離、あるいは、データとクラスタ間の距離を計算する必要がある。これには、単連結法（最近隣距離法）、完全連結法（最遠隣距離法）、群平均法の3種類の方法を使う。

時系列データ間の距離には、まず、時系列データを単に固定長のベクトルと見て、それらの差のノルムをとるユークリッド距離がある。ユークリッド距離の計算は簡単であるが、計算したい2つの時系列データについて、データ数が同じでないと、ユークリッド距離を定義することができない。また、データが記録された時間が違うと、計算することができない。
そこで、データ数が違ったり、記録された時間が違ったりしても計算が可能なDTW距離も利用する。また、DTW距離であれば、形が似ていても時間がずれている、というデータ間の距離を計算するとき、ユークリッド距離と比較して距離が小さくなる。

データ点の数が違ったり、データが記録された時間が違ったりしても距離を計算する別の方法として、欠損しているデータの補間がある。2つのデータ点の間にある値を利用したいときに、その近辺のデータ点を使って値を導出する。本研究では、線形補間を用いた。線形補間は、ある時間に取られた2つのデータ点の間で、値が線形に変化しているものと仮定してデータを補間する方法である。具体的に式で表すと、
2つのデータ点$(a_1, b_1), (a_2, b_2) \ \  (a_1 \le a_2)$があり、$a_1 \le a \le a_2$となるようなデータ点$(a, b)$は、次のようになる。
\[
b = \frac{(a - a_0)b_1 + (a_1 - a)b_0}{a_1 - a_0}
\]
本研究では、子供の学習データ間の距離を計算するのに、線形補間の使い方を2通り試した。
1つ目は、あるデータ点以前に、データが存在しない場合、時間0におけるデータの値を0と仮定して線形補間を行い、あるデータ点以降にデータが存在しない場合、最後のデータ点から値が変化しないものと仮定して補間を行う方法である。2つ目は、あるデータ点以前にデータが存在しない場合は、それ以前の範囲については距離計算に利用せず、更にあるデータ点以降にデータが存在しない場合は、それ以降の範囲については距離計算に利用せず、データが存在する範囲内のみを使って距離計算を行う方法である。1つ目を線形補間A、2つ目を線形補間Bと呼ぶことにする。

ユークリッド距離とDTW距離のどちらも、時系列データのデータ点の数が多くなると距離が大きくなってしまうため、データ点の数で正規化を行うことで、データ点の数が多い形が似ている時系列データ間の距離が小さくなるようにする。実験では、正規化した距離と正規化をしない距離の両方について検討する。
